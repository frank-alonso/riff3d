---
phase: 05-collaboration
plan: 06
type: execute
wave: 5
depends_on: ["05-03", "05-04", "05-05"]
files_modified:
  - .planning/phases/05-collaboration/05-06-SUMMARY.md
  - .planning/reviews/phase-5/PHASE_5_EVIDENCE.md
autonomous: false
requirements: ["COLLAB-01", "COLLAB-02", "COLLAB-03", "COLLAB-04", "COLLAB-05"]

must_haves:
  truths:
    - "Two users editing the same scene see each other's changes appear within 2 seconds"
    - "Concurrent edits on different properties of the same entity are both preserved"
    - "Entity locking works with hierarchical propagation and auto-release"
    - "Avatar mode shows embodied capsule to other users"
    - "Each user has independent undo stack"
  artifacts:
    - path: ".planning/reviews/phase-5/PHASE_5_EVIDENCE.md"
      provides: "Evidence packet for Codex post-execution review"
  key_links:
    - from: "PHASE_5_EVIDENCE.md"
      to: "05-01 through 05-05 SUMMARY files"
      via: "Evidence references all plan summaries"
      pattern: "05-0[1-5]-SUMMARY"
---

<objective>
Phase 5 Review: verify all collaboration features work end-to-end, produce evidence packet for Codex post-execution review, and obtain gate decision.

Purpose: Phase 5 is a standard delivery phase. The post-execution review validates that real-time collaboration, presence, locking, avatars, and independent undo stacks all work correctly before building the game layer on top.

Output: Evidence packet, Codex review, gate decision
</objective>

<execution_context>
@/home/frank/.claude/get-shit-done/workflows/execute-plan.md
@/home/frank/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/PHASE_REVIEW_PROTOCOL.md
@.planning/phases/05-collaboration/05-01-SUMMARY.md
@.planning/phases/05-collaboration/05-02-SUMMARY.md
@.planning/phases/05-collaboration/05-03-SUMMARY.md
@.planning/phases/05-collaboration/05-04-SUMMARY.md
@.planning/phases/05-collaboration/05-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Compile evidence packet and run post-execution review</name>
  <files>
    .planning/reviews/phase-5/PHASE_5_EVIDENCE.md
  </files>
  <action>
    Compile the Phase 5 evidence packet covering all five success criteria:

    1. **Two users editing same scene see changes within 2 seconds** (COLLAB-01)
       - Verify: Open two browser tabs to same project, edit in one, observe change in other
       - Evidence: Test results from Hocuspocus sync, Y.Doc observation latency

    2. **Concurrent edits on different properties preserved** (COLLAB-05)
       - Verify: Edit position in tab A, edit material in tab B simultaneously
       - Evidence: Both edits preserved in final ECSON state

    3. **Entity locking with hierarchical propagation** (COLLAB-03)
       - Verify: Lock parent entity, verify descendants also locked, verify other user sees read-only inspector
       - Evidence: Lock manager tests, hierarchy UI screenshots

    4. **Embodied avatar editing** (COLLAB-04)
       - Verify: Toggle avatar mode, walk with WASD, verify other user sees capsule
       - Evidence: Avatar controller tests, viewport rendering

    5. **Independent undo stacks** (COLLAB-01)
       - Verify: User A edits, User B edits, User A undoes -- only A's edit reverted
       - Evidence: Y.UndoManager configuration (captureTimeout:0, trackedOrigins)

    Also verify carry-forward resolution:
    - CF-P4-01: ESLint mutation boundary enforcement in place
    - CF-P4-02: CLAUDE.md exception contract aligned
    - CF-P4-03: CI artifacts uploaded
    - CF-P4-05: Camera sync on engine switch
    - CF-P4-06: Babylon-first race resolved
    - CF-P4-07: Resize rendering stable

    Run full test suite: `pnpm test`, `pnpm typecheck`, `pnpm lint`

    Create evidence packet at `.planning/reviews/phase-5/PHASE_5_EVIDENCE.md`

    Run Codex post-execution review:
    ```bash
    ./scripts/codex-review.sh post-review 5
    ```

    Write response to Codex review, then run final review for gate decision:
    ```bash
    ./scripts/codex-review.sh final-review 5
    ```
  </action>
  <verify>
    - Evidence packet exists and covers all 5 success criteria
    - All carry-forward items documented as resolved
    - Full test suite passes
    - Codex review completed with gate decision
  </verify>
  <done>
    Phase 5 gate decision obtained (PASS, PASS_WITH_CONDITIONS, or FAIL). Evidence packet archived in reviews directory.
  </done>
</task>

</tasks>

<verification>
- All 5 success criteria verified with evidence
- All carry-forward items resolved
- Post-execution review completed
- Gate decision recorded
</verification>

<success_criteria>
- Gate decision: PASS or PASS_WITH_CONDITIONS
- All COLLAB requirements verified
- Evidence packet complete
</success_criteria>

<output>
After completion, create `.planning/phases/05-collaboration/05-06-SUMMARY.md`
</output>
